<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JRA ワイド特化・最終版</title>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background:#f2f2f2;
  margin:0;
  padding:12px;
}
h1 {
  text-align:center;
  font-size:18px;
}
.section {
  background:#fff;
  border-radius:8px;
  padding:12px;
  margin-bottom:10px;
}
.label {
  font-weight:bold;
}
.condition {
  font-size:13px;
  color:#555;
  margin-top:4px;
}
button, select, input {
  width:100%;
  margin-top:8px;
  padding:10px;
  font-size:16px;
}
button {
  background:#1976d2;
  color:#fff;
  border:none;
  border-radius:6px;
}
button.gray {
  background:#aaa;
}
.result {
  text-align:center;
  font-size:20px;
  padding:16px;
}
.buy { color:#0a7d32; }
.skip { color:#b00020; }
.hidden { display:none; }
small { color:#777; }
details { font-size:14px; }
</style>
</head>

<body>

<h1>JRA ワイド特化ツール（最終版）</h1>

<!-- ① 断層 -->
<div class="section">
  <div class="label">① 断層チェック</div>
  <div class="condition">
    単勝オッズで約1.8倍以上の断層があるか
  </div>
  <button onclick="setLayer(true)">はい（断層より上に軸候補あり）</button>
  <button class="gray" onclick="setLayer(false)">いいえ（見送り）</button>
</div>

<!-- ② 軸 -->
<div class="section hidden" id="axisSec">
  <div class="label">② 軸馬の単勝人気</div>
  <div class="condition">
    条件：2〜5番人気 ＋ 断層より上
  </div>
  <select id="axis">
    <option value="">選択</option>
    <option value="2">2番人気</option>
    <option value="3">3番人気</option>
    <option value="4">4番人気</option>
    <option value="5">5番人気</option>
  </select>
</div>

<!-- ③ 相手 -->
<div class="section hidden" id="pairSec">
  <div class="label">③ 相手馬の単勝人気</div>
  <div class="condition">
    条件：6〜10番人気（1頭のみ）
  </div>
  <select id="pair">
    <option value="">選択</option>
    <option value="6">6番人気</option>
    <option value="7">7番人気</option>
    <option value="8">8番人気</option>
    <option value="9">9番人気</option>
    <option value="10">10番人気</option>
  </select>
</div>

<!-- ④ オッズ -->
<div class="section hidden" id="oddsSec">
  <div class="label">④ ワイドオッズ</div>
  <div class="condition">
    条件：6.0〜12.0
  </div>
  <input type="number" step="0.1" id="odds" placeholder="例：7.4">
</div>

<!-- ⑤ 開催場 -->
<div class="section hidden" id="placeSec">
  <div class="label">⑤ 開催場</div>
  <div class="condition">
    ※ JRA全競馬場対象
  </div>
  <select id="place">
    <option value="">選択</option>
    <option value="stable">東京</option>
    <option value="stable">阪神</option>
    <option value="stable">新潟</option>
    <option value="normal">中山</option>
    <option value="normal">京都</option>
    <option value="wild">福島</option>
    <option value="wild">小倉</option>
    <option value="wild">札幌</option>
    <option value="wild">函館</option>
  </select>
  <small>内部的に安定 / 標準 / 波乱に分類されます</small>
</div>

<!-- 判定 -->
<div class="section hidden" id="judgeSec">
  <button onclick="judge()">判定する</button>
</div>

<!-- 結果 -->
<div class="section hidden result" id="result"></div>

<!-- 成績（別レイヤー） -->
<div class="section">
  <details>
    <summary>成績を見る（判定には影響しません）</summary>
    <p>購入数：<span id="buyCnt">0</span></p>
    <p>的中数：<span id="hitCnt">0</span></p>
    <p>回収率：<span id="rate">0</span>%</p>
    <button class="gray" onclick="hit()">的中</button>
    <button class="gray" onclick="miss()">ハズレ</button>
  </details>
</div>

<script>
let layerOK = null;
let lastTime = 0;
let stats = { buy:0, hit:0, bet:0, ret:0 };
let lastOdds = 0;

function setLayer(v){
  if(!v){
    showSkip();
    return;
  }
  document.getElementById("axisSec").classList.remove("hidden");
}

document.getElementById("axis").onchange = () =>
  document.getElementById("pairSec").classList.remove("hidden");
document.getElementById("pair").onchange = () =>
  document.getElementById("oddsSec").classList.remove("hidden");
document.getElementById("odds").oninput = () =>
  document.getElementById("placeSec").classList.remove("hidden");
document.getElementById("place").onchange = () =>
  document.getElementById("judgeSec").classList.remove("hidden");

function factor(t){
  if(t==="stable") return 1.0;
  if(t==="normal") return 0.95;
  return 0.9;
}

function judge(){
  const now = Date.now();
  if(now - lastTime < 30000){
    alert("30秒待ってください");
    return;
  }
  lastTime = now;

  const odds = Number(document.getElementById("odds").value);
  const f = factor(document.getElementById("place").value);

  if(odds < 6 || odds > 12){
    showSkip(); return;
  }

  const score = (12 - odds) * f;
  if(score > 3){
    stats.buy++;
    stats.bet += 100;
    lastOdds = odds;
    showBuy();
  } else {
    showSkip();
  }
  update();
}

function showBuy(){
  const r = document.getElementById("result");
  r.className = "section result buy";
  r.innerHTML = "✅ BUY<br>ワイド1点のみ<br>資金の2％";
  r.classList.remove("hidden");
}

function showSkip(){
  const r = document.getElementById("result");
  r.className = "section result skip";
  r.innerHTML = "❌ SKIP<br>次のレースへ";
  r.classList.remove("hidden");
}

function hit(){
  stats.hit++;
  stats.ret += lastOdds * 100;
  update();
}
function miss(){ update(); }

function update(){
  document.getElementById("buyCnt").textContent = stats.buy;
  document.getElementById("hitCnt").textContent = stats.hit;
  document.getElementById("rate").textContent =
    stats.bet ? Math.round(stats.ret / stats.bet * 100) : 0;
}
</script>

</body>
</html>